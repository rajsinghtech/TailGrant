# TailGrant configuration

temporal:
  address: "ottawa-temporal.keiretsu.ts.net:7233"
  useTsnet: true            # dial Temporal over tailnet via tsnet
  namespace: "default"      # Temporal namespace
  taskQueue: "tailgrant"    # Temporal task queue name

tailscale:
  hostname: "tailgrant-server"     # tsnet hostname
  stateDir: "/var/lib/tailgrant/tsnet"
  # OAuth credentials (worker only, for Tailscale API)
  oauthClientID: ""
  oauthClientSecret: ""
  tailnet: "example.com"    # tailnet name for API calls

server:
  listenAddr: ":80"
  useTLS: false
  tags:
    - "tag:tailgrant"
  service:                          # optional: expose as a Tailscale VIP service
    name: "svc:tailgrant"           # VIP service name
    port: 443                       # advertised port
    https: true                     # HTTPS mode (terminates TLS)
    comment: "TailGrant JIT access" # optional description
    tags:
      - "tag:tailgrant"


worker:
  ephemeral: true
  tags:
    - "tag:tailgrant-worker"

grants:
  - name: "ssh-access"
    description: "Temporary SSH access to a target node"
    tags:
      - "tag:ssh-granted"
    postureAttributes:      # optional posture attributes set on grant activation
      - key: "custom:jit-ssh"
        value: "granted"
        target: "requester" # "requester" (default) or "target"
    maxDuration: "4h"
    riskLevel: "low"        # low | medium | high
    approvers: []           # empty = auto-approve for low risk

  - name: "admin-access"
    description: "Full administrative access to a target node"
    tags:
      - "tag:admin-granted"
    maxDuration: "2h"
    riskLevel: "high"
    approvers:
      - "admin@example.com"
      - "secops@example.com"

  - name: "debug-access"
    description: "Debug-level access for troubleshooting"
    tags:
      - "tag:debug-granted"
    maxDuration: "1h"
    riskLevel: "medium"
    approvers:
      - "oncall@example.com"

  # User-based JIT grant types

  - name: "temp-admin"
    description: "Temporarily elevate user to admin role"
    action: "user_role"
    userAction:
      role: "admin"
    maxDuration: "2h"
    riskLevel: "high"
    approvers:
      - "admin@example.com"

  - name: "temp-restore"
    description: "Temporarily restore a suspended user"
    action: "user_restore"
    maxDuration: "4h"
    riskLevel: "medium"
    approvers:
      - "secops@example.com"
